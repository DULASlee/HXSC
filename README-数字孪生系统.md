# 智慧工地数字孪生系统

## 系统概述

本数字孪生系统是智慧工地管理系统的重要组成部分，提供实时、直观的工地监控和管理功能。系统采用Vue.js 3 + Element Plus前端技术栈和.NET 8后端技术栈，实现了五大核心功能模块。

## 技术架构

### 前端技术栈
- **Vue.js 3** - 现代化前端框架，使用Composition API
- **Element Plus** - 企业级UI组件库
- **ECharts** - 数据可视化图表库
- **TypeScript** - 类型安全的JavaScript超集
- **Vite** - 快速构建工具

### 后端技术栈
- **.NET 8** - 现代化后端框架
- **Entity Framework Core** - ORM数据访问层
- **AutoMapper** - 对象映射工具
- **Swagger** - API文档和测试工具
- **SignalR** - 实时通信框架

## 功能模块

### 1. 指挥中心大屏
- **功能描述**: 提供工地整体概览，实时显示项目、人员、设备、安全等关键指标
- **核心特性**:
  - 项目总览统计（总项目数、在建项目、已完成项目、总投资额）
  - 人员统计（总人数、在场人数、出勤率）
  - 设备统计（设备总数、在线设备、故障设备、在线率）
  - 安全统计（安全事件、安全评分）
  - 实时数据更新（30秒刷新）
  - 项目状态展示（进度、地址、人员、设备信息）
  - 趋势图表分析

### 2. 项目考勤大屏
- **功能描述**: 实时监控工地人员考勤情况，提供考勤统计和分析
- **核心特性**:
  - 今日考勤概览（应到人数、已签到、缺勤、迟到、早退）
  - 实时考勤动态（最新签到记录、当前统计）
  - 班组考勤排行（按出勤率排序）
  - 考勤趋势分析（日趋势、时段分布）
  - 月度考勤统计
  - 实时数据更新（10秒刷新）

### 3. 视频监控大屏
- **功能描述**: 集中展示工地监控摄像头画面和智能分析结果
- **核心特性**:
  - 9宫格视频监控展示
  - 监控设备统计（总数、在线、离线、故障）
  - 录像存储统计（存储空间、使用率、保留天数）
  - AI智能分析（人员检测、安全帽识别、车辆检测、行为分析）
  - 监控点位管理
  - 告警信息统计
  - 实时数据更新（5秒刷新）

### 4. 塔吊升降机管理大屏
- **功能描述**: 监控工地大型设备运行状态和安全指标
- **核心特性**:
  - 设备实时状态展示（载重、高度、风速、工作时长）
  - 设备运行统计（总数、运行、故障、利用率）
  - 安全监控（超载、超高、强风、碰撞检测）
  - 设备详情信息（基本信息、实时数据、安全状态）
  - 工作效率分析（效率趋势、设备排行）
  - 维护管理提醒
  - 实时数据更新（15秒刷新）

### 5. 扬尘噪音监测大屏
- **功能描述**: 环境质量监测和预警，确保施工符合环保要求
- **核心特性**:
  - 扬尘监测（PM2.5、PM10、TSP浓度显示）
  - 噪音监测（当前等级、平均值、最大值）
  - 气象数据（温度、湿度、风速、风向、气压、能见度）
  - 监测点位管理
  - 环境趋势分析（24小时趋势图）
  - 环境告警信息
  - 实时数据更新（60秒刷新）

## 系统特点

### 1. 响应式设计
- 适配桌面端、平板端、移动端
- 自适应布局，支持全屏显示
- 优化的用户体验

### 2. 实时数据
- WebSocket实时通信
- 多层级数据更新频率
- 智能缓存机制

### 3. 丰富的可视化
- 多类型统计卡片
- 动态图表展示
- 渐变色彩搭配
- 动画效果增强

### 4. 模拟数据支持
- 完整的测试数据生成
- 真实的业务场景模拟
- 随机数据变化，模拟实际运行

## 文件结构

```
src/SmartConstruction.Web/src/views/digital-twin/
├── index.vue                          # 主入口页面
├── layout/
│   └── DigitalTwinLayout.vue          # 布局组件
├── screens/
│   ├── CommandCenter.vue              # 指挥中心大屏
│   ├── AttendanceScreen.vue           # 项目考勤大屏
│   ├── VideoMonitor.vue               # 视频监控大屏
│   ├── CraneManagement.vue            # 塔吊升降机管理大屏
│   └── EnvironmentMonitor.vue         # 扬尘噪音监测大屏
├── components/
│   ├── StatisticCard.vue              # 统计卡片组件
│   ├── DataCard.vue                   # 数据卡片组件
│   └── DigitalChart.vue               # 图表组件
└── api/
    └── services/
        ├── digital-twin.service.ts    # 生产API服务
        └── digital-twin-mock.service.ts # 测试数据服务
```

## 后端API结构

```
src/SmartConstruction.Service/
├── Controllers/
│   └── DigitalTwinController.cs       # 数字孪生API控制器
├── Services/
│   ├── IDigitalTwinService.cs         # 服务接口
│   └── DigitalTwinService.cs          # 服务实现
└── docs/
    └── 数字孪生大屏API接口规范.md      # API接口文档
```

## 启动说明

### 前端启动
```bash
cd src/SmartConstruction.Web
npm install
npm run dev
```

### 后端启动
```bash
cd src/SmartConstruction.Service
dotnet restore
dotnet run
```

### 访问地址
- 前端: http://localhost:5173
- 后端API: http://localhost:5220
- Swagger文档: http://localhost:5220/swagger
- 数字孪生页面: http://localhost:5173/digital-twin

## 测试数据

系统提供了丰富的测试数据，包括：

### 指挥中心测试数据
- 15个项目（12个活跃，3个已完成）
- 1850总人员，1245在场人员
- 267台设备，234台在线
- 实时变化的统计数据

### 考勤测试数据
- 1245名工人的考勤记录
- 5个班组的排行数据
- 实时签到动态
- 7天考勤趋势数据

### 视频监控测试数据
- 45个监控摄像头
- AI分析结果（人员234人，车辆23辆）
- 智能告警信息
- 存储统计数据

### 设备管理测试数据
- 28台设备（塔吊、升降机）
- 实时运行参数（载重、高度、风速）
- 安全监控状态
- 效率分析数据

### 环境监测测试数据
- PM2.5、PM10、TSP浓度数据
- 噪音分贝监测
- 气象数据（温湿度、风速风向）
- 24小时趋势数据

## 开发说明

### 添加新的大屏模块
1. 在`screens/`目录创建新的Vue组件
2. 在`index.vue`中注册新组件
3. 在`digitalTwinTabs`中添加新标签
4. 在后端添加对应的API接口

### 自定义组件开发
- 使用`StatisticCard`展示统计数据
- 使用`DataCard`包装复杂内容
- 使用`DigitalChart`展示图表
- 遵循响应式设计原则

### API接口开发
1. 在`IDigitalTwinService`中定义接口
2. 在`DigitalTwinService`中实现逻辑
3. 在`DigitalTwinController`中添加控制器方法
4. 在Program.cs中注册服务

## 部署说明

### 开发环境
- 使用mock数据服务进行开发测试
- 支持热重载和实时调试

### 生产环境
- 切换到真实API服务
- 配置WebSocket连接
- 配置数据库连接
- 设置缓存策略

## 性能优化

### 前端优化
- 组件懒加载
- 图表按需渲染
- 数据缓存策略
- 防抖节流处理

### 后端优化
- 异步数据处理
- 内存缓存优化
- 数据库查询优化
- API响应压缩

## 扩展功能

### 未来规划
- 3D建模可视化
- VR/AR集成
- 机器学习预测
- 移动端App
- 物联网设备接入

### 集成能力
- 第三方监控系统
- 政府监管平台
- ERP系统对接
- 移动消息推送

---

## 技术支持

如有技术问题，请参考：
1. API接口文档：`docs/数字孪生大屏API接口规范.md`
2. 前端组件文档：各组件内的注释说明
3. 测试数据服务：`digital-twin-mock.service.ts`

本系统已完成基础框架搭建和核心功能实现，可直接用于开发和演示。